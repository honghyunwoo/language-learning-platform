# 실전 회화 연습 기능 테스트 가이드

## 🚀 테스트 준비

### 1. 서버 시작
```bash
# 개발 서버 (포트 3008)
npm run dev

# Firebase 에뮬레이터 (Firestore)
firebase emulators:start --only firestore
```

### 2. 브라우저 접속
- URL: http://localhost:3008
- 로그인 필요 (테스트 계정 사용)

## ✅ 테스트 체크리스트

### Phase 1: 대화 목록 페이지 (/dashboard/conversations)

- [ ] **페이지 접근**
  - 사이드바에 "실전 회화 연습" 메뉴가 표시됨
  - 메뉴 클릭 시 `/dashboard/conversations`로 이동

- [ ] **대화 카드 표시**
  - 5개의 대화 시나리오 카드가 표시됨:
    1. 카페에서 주문하기 (cafe-order)
    2. 길 물어보기 (asking-directions)
    3. 자기소개하기 (self-introduction)
    4. 전화로 예약하기 (phone-reservation)
    5. 쇼핑하기 (shopping)

  - 각 카드에 다음 정보 표시:
    - 제목 (title)
    - 설명 (description)
    - 레벨 배지 (A1, A2, B1, B2)
    - 예상 소요 시간
    - 어휘 개수
    - 핵심 표현 개수

- [ ] **레벨 필터**
  - "전체", "A1", "A2", "B1", "B2" 버튼 표시
  - 각 버튼 클릭 시 해당 레벨의 대화만 필터링됨

- [ ] **통계 표시** (대화 연습 기록이 있는 경우)
  - 완료한 대화 수
  - 총 연습 횟수
  - 평균 점수

### Phase 2: 대화 시뮬레이션 페이지 (/dashboard/conversations/[id])

- [ ] **페이지 진입**
  - 대화 카드의 "시작하기" 버튼 클릭
  - 페이지 로드 시 로딩 스피너 표시
  - 대화 데이터 로드 완료 후 시작 화면 표시

- [ ] **헤더 정보**
  - "← 목록으로" 버튼 (클릭 시 목록 페이지로 이동)
  - 레벨 배지
  - 대화 제목
  - 시나리오 정보 (장소, 상황)

- [ ] **점수 및 진행률**
  - 현재 점수 / 최대 점수 표시
  - 진행률 바 (0-100%)
  - "다시 시작" 버튼 작동

- [ ] **대화 흐름**
  - **일반 대화 노드**:
    - 캐릭터 아바타 표시
    - 캐릭터 이름 표시
    - 영어 대화 텍스트
    - 한국어 번역
    - 문화적 노트 (있는 경우)
    - "계속 →" 버튼으로 다음으로 이동

  - **선택지 노드**:
    - "어떻게 대답하시겠어요?" 안내 텍스트
    - 2-4개의 선택지 버튼
    - 각 선택지에 영어 텍스트 + 한국어 번역

### Phase 3: 피드백 시스템

- [ ] **선택 후 피드백 표시**
  - 피드백 카드가 1.5초간 표시됨
  - 3가지 피드백 타입:
    - 🎉 훌륭합니다! (excellent) - 초록색
    - 👍 좋아요! (good) - 파란색
    - 💡 개선이 필요해요 (needs-improvement) - 주황색

  - 피드백 내용:
    - 피드백 메시지
    - 더 나은 표현 (suggestion) - 있는 경우
    - 문화적 노트 (culturalNote) - 있는 경우

- [ ] **점수 업데이트**
  - 선택에 따라 점수가 증가함
  - excellent: +3점
  - good: +2점
  - needs-improvement: +1점

### Phase 4: 대화 완료

- [ ] **완료 화면**
  - 🎊 이모지 표시
  - "대화 완료!" 제목
  - 완료 메시지
  - 최종 점수 / 최대 점수
  - 백분율 점수

- [ ] **완료 액션**
  - "목록으로" 버튼 - 대화 목록으로 이동
  - "결과 저장" 버튼 - Firestore에 결과 저장 후 목록으로 이동

### Phase 5: 학습 자료

- [ ] **어휘 섹션**
  - "📝 주요 어휘" 제목
  - 상위 5개 어휘 표시
  - 각 어휘: 단어, 발음, 의미

- [ ] **핵심 표현 섹션**
  - "💬 핵심 표현" 제목
  - 상위 5개 핵심 표현 표시
  - 각 표현: 표현, 의미

### Phase 6: Firestore 통합

- [ ] **진행률 저장**
  - 각 선택마다 진행률이 Firestore에 저장됨
  - Collection: `conversationProgress`
  - 저장 내용: userId, conversationId, currentNodeId, score, choices

- [ ] **진행률 불러오기**
  - 페이지 재방문 시 이전 진행 상태에서 계속 가능
  - 현재 노드, 점수, 선택 기록 복원

- [ ] **결과 저장**
  - 대화 완료 시 결과가 Firestore에 저장됨
  - Collection: `conversationResults`
  - 저장 내용: userId, conversationId, score, maxScore, percentage, completedAt

- [ ] **통계 업데이트**
  - 목록 페이지의 통계가 결과 데이터 기반으로 업데이트됨
  - 완료 배지 ("✓ 완료") 표시
  - 연습 횟수 카운트

### Phase 7: 에러 처리

- [ ] **JSON 로드 실패**
  - 에러 메시지 콘솔에 표시
  - 해당 대화는 목록에서 제외됨

- [ ] **Firestore 에러**
  - 저장 실패 시에도 대화 진행 가능
  - 에러 메시지 표시

- [ ] **네트워크 오류**
  - 적절한 로딩 상태 표시
  - 재시도 로직 또는 에러 메시지

## 🐛 알려진 이슈 및 제한사항

### 현재 구현 완료
- ✅ 5개 대화 JSON 데이터
- ✅ 대화 목록 페이지 UI
- ✅ 대화 시뮬레이션 페이지 UI
- ✅ 분기형 선택 시스템
- ✅ 피드백 시스템
- ✅ 점수 계산
- ✅ 학습 자료 표시
- ✅ Firestore 연동 (진행률, 결과)

### 미구현 기능
- ⏳ TTS (Text-to-Speech) - 음성 재생
- ⏳ STT (Speech-to-Text) - 음성 입력 (말하기 연습)
- ⏳ 대화 녹음 및 재생
- ⏳ 발음 평가
- ⏳ 반복 연습 추천

### 개선 필요 사항
- 피드백 애니메이션 타이밍 조정 가능성
- 모바일 반응형 UI 최적화 필요
- 접근성 (Accessibility) 개선
- 에러 핸들링 강화

## 📊 테스트 결과 기록

### 테스트 날짜: 2025-10-09
### 테스터: [이름]

| 항목 | 결과 | 비고 |
|------|------|------|
| 대화 목록 로드 | ⬜ | |
| 레벨 필터 작동 | ⬜ | |
| 대화 시작 | ⬜ | |
| 선택지 표시 | ⬜ | |
| 피드백 표시 | ⬜ | |
| 점수 계산 | ⬜ | |
| 대화 완료 | ⬜ | |
| Firestore 저장 | ⬜ | |
| 진행률 복원 | ⬜ | |
| 통계 표시 | ⬜ | |

### 발견된 버그
1.
2.
3.

### 개선 제안
1.
2.
3.

## 🔧 디버깅 팁

### 브라우저 콘솔 확인
```javascript
// React Query 캐시 확인
window.__REACT_QUERY_DEVTOOLS__

// Firestore 연결 확인
console.log(db)

// 현재 로드된 대화 확인
// (대화 페이지에서)
```

### Firebase 에뮬레이터 UI
- URL: http://localhost:4000
- Firestore 데이터 확인 가능
- Collection: conversationProgress, conversationResults

### Next.js 개발자 도구
- Fast Refresh 활성화됨
- 파일 저장 시 자동 리로드
- 에러는 브라우저 오버레이에 표시

## 📝 테스트 시나리오 예제

### 시나리오 1: 카페 주문 완전 체험
1. "카페에서 주문하기" 선택
2. 모든 대화 노드 진행
3. 각 선택지에서 다양한 옵션 선택
4. 피드백 확인
5. 최종 완료 및 결과 저장
6. 목록으로 돌아가서 "✓ 완료" 배지 확인

### 시나리오 2: 진행률 복원 테스트
1. "길 물어보기" 시작
2. 중간까지 진행 (50% 정도)
3. 브라우저 새로고침 (F5)
4. 페이지 다시 로드 후 이전 진행 상태 확인
5. 계속 진행하여 완료

### 시나리오 3: 반복 연습
1. "자기소개하기" 완료
2. 목록으로 돌아가기
3. "다시 연습하기" 버튼 확인
4. 다시 시작하여 다른 선택지 선택
5. 통계에서 "2회 연습" 표시 확인

## 🎯 성공 기준

Phase 3 (실전 회화 연습)는 다음 조건이 모두 충족되면 완료로 간주됩니다:

1. ✅ 5개 대화 시나리오 모두 정상 로드
2. ✅ 대화 흐름이 끊김 없이 진행
3. ✅ 모든 선택지 분기가 올바르게 작동
4. ✅ 피드백이 적절하게 표시
5. ✅ 점수가 정확하게 계산
6. ✅ Firestore 저장/불러오기 정상 작동
7. ✅ 완료 후 통계가 업데이트
8. ✅ 반응형 UI (모바일, 태블릿, 데스크톱)
9. ✅ 에러 없이 전체 플로우 완료 가능
10. ✅ Production 빌드 성공
